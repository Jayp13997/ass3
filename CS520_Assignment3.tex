%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Do not alter this block (unless you're familiar with LaTeX
\documentclass{article}
\usepackage[margin=1in]{geometry} 
\usepackage{amsmath,amsthm,amssymb,amsfonts, fancyhdr, color, comment, graphicx, environ}
\usepackage{xcolor}
\usepackage{mdframed}
\usepackage[shortlabels]{enumitem}
\usepackage{indentfirst}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=blue,
}


\pagestyle{fancy}


\newenvironment{problem}[2][Problem]
    { \begin{mdframed}[backgroundcolor=gray!20] \textbf{#1 #2} \\}
    {  \end{mdframed}}

% Define solution environment
\newenvironment{solution}{\textbf{Solution}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fill in the appropriate information below
\lhead{Michael Yen and Jay Patel}
\rhead{CS520} 
\chead{\textbf{Assignment 3}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}

\begin{problem}{1}
Marie is getting married tomorrow at an outdoor ceremony in NYC. In recent years,
it rained about once every three days. The weatherman has predicted there will be no rain for
tomorrow. When it actually rains, the weatherman correctly forecasts rain 80 percent of the time. When
it doesn’t rain, he incorrectly forecasts rain 20 percent of the time. What is the probability that it will
rain on the day of Marie’s wedding according to Bayes’ rule?
\end{problem}

\begin{solution} \\
Let A = the event that it rains \\
Let B = the event that the weatherman predicts no rain \\
\begin{align}
P(A | B) &= \frac{P(B | A) * P(A)}{P(B)} \\
&= \frac{\frac{1}{5} * \frac{1}{3}}{\frac{1}{3} * \frac{1}{5} + \frac{2}{3} * \frac{4}{5}} \\
&= \frac{\frac{1}{15}}{\frac{1}{15}+\frac{8}{15}} \\
&= \frac{\frac{1}{15}}{\frac{9}{15}} \\
&= \frac{1}{9}
\end{align}
\end{solution}

\begin{problem}{2}
Consider the Monty Hall problem that we discussed in class. Instead of having three
doors with one door having a price, now suppose there are four doors with two doors hiding goats
behind them and one door having a price behind it. The other door has nothing behind it. To play
the game, the guest will pick a door and the host will then reveal another door with a goat behind.
The guest can then choose whether to stick to the original choice or switching. Should the guest
switch? What is the probability of winning if the guest switches?
\end{problem}

\begin{solution}
Yes, the guest should still switch. Here's all the possible results for switching: \\
Pick prize, switch to remaining goat \\
Pick prize, switch to nothing \\
Pick goat number one, switch to nothing \\
Pick goat number one, switch to prize \\
Pick goat number two, switch to nothing \\
Pick goat number two, switch to prize \\
Pick nothing, switch to remaining goat \\
Pick nothing, switch to prize \\

Here's all the possible results without switching: \\
Pick prize \\
Pick goat number one \\
Pick goat number two \\
Pick nothing \\

As shown, switching will provide a $\frac{3}{8}$ chance to win as opposed to a $\frac{1}{4} = \frac{2}{8}$ chance at the start of the game.
\end{solution}

\begin{problem}{3}
Consider the following Bayesian network, where variables A through E are all Boolean valued. \\
a) What is the probability that all five of these Boolean variables are true? \\
b) Compute $P(A, E | B)$ (yes, this is a lot of work). \\
c) Compute $P(A = true | B = false, C = false, D = false, E = false)$. \\
d) Compute $P(C = true, D = false | B = false)$. \\
e) Compute $P(B = true, C = false, D = true | A = false)$.
\end{problem}

\begin{solution}
a) $0.2 * 0.5 * 0.8 * 0.1 * 0.3 = .0024$ \\
b) $P(A) * P(E | B) = 0.2 * (.8* .2 + .3 * .8) = 0.08$ \\
c) $P(A = true | B = false, C = false, D = false, E = false) = P(A = true | D = false) = \frac{P(D|A) * P(A)}{P(D)} = \frac{(0.5*0.5 + 0.5*0.1) * 0.2}{0.8* 0.5*0.9 + 0.8 * 0.5* 0.6 + 0.2 * 0.5 * 0.5 + 0.2*0.5*0.1} = \frac{1}{11}$ \\
d) $P(C = true, D = false | B = false) = P(C = true) * P(D = false | B  = false) = 0.8 * (0.8*0.1 + 0.2*0.5) = 0.144$ \\
e) $P(B = true, C = false, D = true | A = false) = 0.5 * 0.2 * 0.6 = .06 $ 
% This problem is confusing me a bit
\end{solution}

\begin{problem}{4}
Using information gain as the criteria for deciding the node to split, learn the decision
tree to depth 2 (i.e., the root should have grandchildren) using the data provided in Table 1. Show
your work, i.e., how do you decide which feature to use for each split. For each split, clearly mark
how the samples are grouped. For this purpose, you may use the “Day” as the identifier of the
samples. As an example, if you start with samples for day 01, 02, and 03, after a split, you may
have two children nodes, one with {01, 03} and the other with {02}
\end{problem}

\begin{solution}
See other pdf of paper and pencil work.
\end{solution}


\begin{problem}{5}
a) Compute a linear classifier using $\alpha = 0.8$ and using the samples in the following order [-1, 3], [1, 6], [0, 1], [1, 5], [0, 2], [0, 0], [3, 3]. 
Show your work for the first seven iterations and also provide the final $w = (w_0 = b, w_1, w_2)$.
b) Plot the training points and, by inspection, draw a linear classifier that separates the data with maximum margin.
c) This linear SVM is parametrized by $h(x) = w^T x + b$. Estimate the parameters w and b for the classifier that you have drawn.
d) Suppose you observe an additional set of points, all from the positive class: $[-2, 0]^T, [-2, 1]^T, [-2, 3]^T, [-1, 0]^T, [-1, 1]^T, [0, 0]^T$.
What is the linear SVM (in terms of w and b) now?
\end{problem}

\begin{solution}
See other pdf of paper and pencil work.

5c) w = [-0.25, 0.4], b = 4
\end{solution}

\begin{problem}{6}
What is the VC-dimension of (a) two half-planes (i.e., two linear separators)? (b) the
inside of a triangle? Explain.
\end{problem}

\begin{solution}
a) The VC-dimension of two half-planes (two perceptrons) is 5. With 6 points arranged in a hexagon shape alternating between + and -, it is impossible to shatter this configuration. However, it can shatter any configuration of a set of 5 points. \\
b) The VC-dimension of a triangle is 7. With 8 points arranged in a octagon shape alternating between + and -, it is impossible to shatter this configuration with a triangle. With 7, if there are 3 + and 4 - alternating for example, it can surround the 3 - inside of it.
\end{solution}

\begin{problem}{7}
a) The first two iterations of your computation. \\
b) The converged rewards and the extracted policy. For this problem, you need to provide last two iterations showing that the value changes are within 0.001 for all cells.
\end{problem}

\begin{solution}
See other pdf of paper and pencil work.
\end{solution}
\end{document}